<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>上传博客到npm，并分流到npm镜像提升速度，可绕备</title>
      <link href="/2022/12/09/%E4%B8%8A%E4%BC%A0%E5%8D%9A%E5%AE%A2%E5%88%B0npm%EF%BC%8C%E5%B9%B6%E5%88%86%E6%B5%81%E5%88%B0npm%E9%95%9C%E5%83%8F%E6%8F%90%E5%8D%87%E9%80%9F%E5%BA%A6/"/>
      <url>/2022/12/09/%E4%B8%8A%E4%BC%A0%E5%8D%9A%E5%AE%A2%E5%88%B0npm%EF%BC%8C%E5%B9%B6%E5%88%86%E6%B5%81%E5%88%B0npm%E9%95%9C%E5%83%8F%E6%8F%90%E5%8D%87%E9%80%9F%E5%BA%A6/</url>
      
        <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>之前看过w03.cc的文章，但是他只是上传到npm并更改package.json里的代码，我也有对应的实现方法，见</p><p><a href="https://blog.abeginner.cn/2022/12/04/%E4%BD%BF%E7%94%A8%E5%A4%9A%E6%96%B9%E6%B3%95%E7%BB%99hexo%E5%8A%A0%E9%80%9F/">haor (abeginner.cn)</a></p><p>我是把package.json和cw配置项里的分流地址版本都改了，因为饿了么和其他国内的npm镜像基本都是回源有问题不能直接获取最新版本，只能靠指定版本使用，但是要注意的是，我之前那篇文章写的不详细，有一些小细节会出错，比如hexo配置要填写跳过cw的配置文件，和文件位置放的不正确，所以就有了这篇文章</p><h2 id="这里会说两种前端使用npm镜像的方式，一种是用sw，一种是用cw"><a href="#这里会说两种前端使用npm镜像的方式，一种是用sw，一种是用cw" class="headerlink" title="这里会说两种前端使用npm镜像的方式，一种是用sw，一种是用cw"></a>这里会说两种前端使用npm镜像的方式，一种是用sw，一种是用cw</h2><h1 id="首先，使用github-action上传博客到npm"><a href="#首先，使用github-action上传博客到npm" class="headerlink" title="首先，使用github action上传博客到npm"></a>首先，使用github action上传博客到npm</h1><h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2><ol><li>要在上传之前在博客根目录的source目录下执行npm init来创建package.json</li><li>要设置好github action的npm源为官方源</li><li>要设置好secrets</li><li>把博客根目录除node_modules外的所有文件和文件夹上传到一个github仓库并在根目录创建.github/workflows/autopublish.yml</li><li>nodejs版本为16.x</li></ol><h2 id="我目前在用的代码"><a href="#我目前在用的代码" class="headerlink" title="我目前在用的代码"></a>我目前在用的代码</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">name: 自动部署</span><br><span class="line"></span><br><span class="line">on:</span><br><span class="line">  push:</span><br><span class="line">    branches:</span><br><span class="line">      - master</span><br><span class="line"></span><br><span class="line">jobs:</span><br><span class="line">  my_first_job:</span><br><span class="line">    name: my first job</span><br><span class="line">    runs-on: ubuntu-latest</span><br><span class="line">    steps:</span><br><span class="line">      - name: 检查分支</span><br><span class="line">        uses: actions/checkout@v2</span><br><span class="line">        with:</span><br><span class="line">          ref: master</span><br><span class="line"></span><br><span class="line">      - name: 安装 Node</span><br><span class="line">        uses: actions/setup-node@v1</span><br><span class="line">        with:</span><br><span class="line">          node-version: &quot;16.x&quot;</span><br><span class="line">          registry-url: https://registry.npmjs.org/</span><br><span class="line"></span><br><span class="line">      - name: 安装 Hexo</span><br><span class="line">        run: |</span><br><span class="line">          export TZ=&#x27;Asia/Shanghai&#x27;</span><br><span class="line">          npm install hexo-cli -g</span><br><span class="line"></span><br><span class="line">      - name: 缓存 Hexo</span><br><span class="line">        id: cache-npm</span><br><span class="line">        uses: actions/cache@v3</span><br><span class="line">        env:</span><br><span class="line">          cache-name: cache-node-modules</span><br><span class="line">        with:</span><br><span class="line">          path: node_modules</span><br><span class="line">          key: $&#123;&#123; runner.os &#125;&#125;-build-$&#123;&#123; env.cache-name &#125;&#125;-$&#123;&#123; hashFiles(&#x27;**/package-lock.json&#x27;) &#125;&#125;</span><br><span class="line">          restore-keys: |</span><br><span class="line">            $&#123;&#123; runner.os &#125;&#125;-build-$&#123;&#123; env.cache-name &#125;&#125;-</span><br><span class="line">            $&#123;&#123; runner.os &#125;&#125;-build-</span><br><span class="line">            $&#123;&#123; runner.os &#125;&#125;-</span><br><span class="line"></span><br><span class="line">      - name: 安装依赖</span><br><span class="line">        if: $&#123;&#123; steps.cache-npm.outputs.cache-hit != &#x27;true&#x27; &#125;&#125;</span><br><span class="line">        run: |</span><br><span class="line">          npm install --save</span><br><span class="line"></span><br><span class="line">      - name: 生成静态文件</span><br><span class="line">        run: |</span><br><span class="line">          hexo generate</span><br><span class="line"></span><br><span class="line">      - name: 推送到npm镜像</span><br><span class="line">        run: |</span><br><span class="line">          cd public</span><br><span class="line">          node npmversionupdata.js</span><br><span class="line">          npm publish</span><br><span class="line">        env:</span><br><span class="line">          NODE_AUTH_TOKEN: $&#123;&#123;secrets.npm_token&#125;&#125;</span><br><span class="line">  </span><br><span class="line">      - name: 部署到Github</span><br><span class="line">        uses: JamesIves/github-pages-deploy-action@v4</span><br><span class="line">        with:</span><br><span class="line">          token: $&#123;&#123;secrets.myblog_token&#125;&#125;</span><br><span class="line">          repository-name: lhr20080401/site</span><br><span class="line">          branch: main</span><br><span class="line">          folder: public</span><br><span class="line">          commit-message: &quot;Updated blog By Github Actions&quot;</span><br></pre></td></tr></table></figure><h2 id="使用到你自己的脚本里去"><a href="#使用到你自己的脚本里去" class="headerlink" title="使用到你自己的脚本里去"></a>使用到你自己的脚本里去</h2><p>在博客根目录创建.github/workflows/autopublish.yml</p><p>以下代码是上传文件到npm的关键</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">- name: 推送到npm镜像</span><br><span class="line">        run: |</span><br><span class="line">          cd public</span><br><span class="line">          node npmversionupdata.js</span><br><span class="line">          npm publish</span><br><span class="line">        env:</span><br><span class="line">          NODE_AUTH_TOKEN: $&#123;&#123;secrets.npm_token&#125;&#125;</span><br></pre></td></tr></table></figure><p>在此之前，在github action上安装nodejs的时候要特别注意</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">- name: 安装 Node</span><br><span class="line">        uses: actions/setup-node@v1</span><br><span class="line">        with:</span><br><span class="line">          node-version: &quot;16.x&quot;</span><br><span class="line">          registry-url: https://registry.npmjs.org/</span><br></pre></td></tr></table></figure><p>版本为16.x，源为官方源</p><p>在博客根目录的source创建npmversionupdata.js（注意gulp请不要打包它）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">var fs = require(&#x27;fs&#x27;);</span><br><span class="line">var timestamp=new Date().getTime()</span><br><span class="line">function changeJson(timestamp)&#123;</span><br><span class="line">    fs.readFile(&#x27;package.json&#x27;,function(err,data)&#123;</span><br><span class="line">        if(err)&#123;</span><br><span class="line">            console.error(err);</span><br><span class="line">        &#125;</span><br><span class="line">        var person = data.toString();</span><br><span class="line">        person = JSON.parse(person);</span><br><span class="line">        person.version = &quot;1.0.&quot; + timestamp</span><br><span class="line">        var str = JSON.stringify(person);</span><br><span class="line">        fs.writeFile(&#x27;package.json&#x27;,str,function(err)&#123;</span><br><span class="line">            if(err)&#123;</span><br><span class="line">                console.error(err);</span><br><span class="line">            &#125;</span><br><span class="line">            console.log(&#x27;修改成功&#x27;);</span><br><span class="line">            console.log(person.version);</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line">function changeconfig(timestamp) &#123;</span><br><span class="line">    fs.readFile(&#x27;config.yaml&#x27;,&#x27;utf8&#x27;,function(err,files)&#123;</span><br><span class="line">        var result = files.replace(/1.0.000919/g,&quot;1.0.&quot; + timestamp);</span><br><span class="line">        console.log(&quot;ok&quot;)</span><br><span class="line">        fs.writeFile(&#x27;config.yaml&#x27;, result, &#x27;utf8&#x27;, function (err) &#123;</span><br><span class="line">             if (err) return console.log(err);</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">    &#125;)</span><br><span class="line">&#125;;</span><br><span class="line">changeJson(timestamp)</span><br><span class="line">changeconfig(timestamp)</span><br></pre></td></tr></table></figure><p>这个文件就是用时间管理npm版本，防止npm重新提交版本和前端获取不到最新版本的问题</p><h2 id="注意第二个函数是给clientworker更改配置项分流地址的，需要你把分流地址写成这个样子-镜像站点-包名-1-0-000919注意000919不可变他就是靠正则替换这串数字"><a href="#注意第二个函数是给clientworker更改配置项分流地址的，需要你把分流地址写成这个样子-镜像站点-包名-1-0-000919注意000919不可变他就是靠正则替换这串数字" class="headerlink" title="注意第二个函数是给clientworker更改配置项分流地址的，需要你把分流地址写成这个样子:镜像站点/包名@1.0.000919注意000919不可变他就是靠正则替换这串数字"></a>注意第二个函数是给clientworker更改配置项分流地址的，需要你把分流地址写成这个样子:镜像站点/包名@1.0.000919注意000919不可变他就是靠正则替换这串数字</h2><h2 id="上传完建议直接push到另一个仓库，然后用你需要的服务绑定这个仓库（例如vercel）因为我们不可能让同样的代码在vercel之类的平台上再执行一遍，因为这样时间就不相同版本也不相同（靠时间截来控制版本），部署在他们上面的网站的分流链接就不是GitHub-action上传的版本了"><a href="#上传完建议直接push到另一个仓库，然后用你需要的服务绑定这个仓库（例如vercel）因为我们不可能让同样的代码在vercel之类的平台上再执行一遍，因为这样时间就不相同版本也不相同（靠时间截来控制版本），部署在他们上面的网站的分流链接就不是GitHub-action上传的版本了" class="headerlink" title="上传完建议直接push到另一个仓库，然后用你需要的服务绑定这个仓库（例如vercel）因为我们不可能让同样的代码在vercel之类的平台上再执行一遍，因为这样时间就不相同版本也不相同（靠时间截来控制版本），部署在他们上面的网站的分流链接就不是GitHub action上传的版本了"></a>上传完建议直接push到另一个仓库，然后用你需要的服务绑定这个仓库（例如vercel）因为我们不可能让同样的代码在vercel之类的平台上再执行一遍，因为这样时间就不相同版本也不相同（靠时间截来控制版本），部署在他们上面的网站的分流链接就不是GitHub action上传的版本了</h2><h1 id="使用service-worker分流到npm国内镜像"><a href="#使用service-worker分流到npm国内镜像" class="headerlink" title="使用service worker分流到npm国内镜像"></a>使用service worker分流到npm国内镜像</h1><p>在hexo根目录的source文件夹下创建sw.js（注意gulp请不要打包它）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">hostname = self.location.host;</span><br><span class="line">console.log(hostname);</span><br><span class="line">// 在 service worker 中监听 fetch 事件</span><br><span class="line">self.addEventListener(&#x27;fetch&#x27;, function(event) &#123;</span><br><span class="line">  if (event.request.url.indexOf(hostname) !== -1) &#123;</span><br><span class="line">    var url = new URL(event.request.url);</span><br><span class="line">    url.protocol = &quot;https&quot;;</span><br><span class="line">    url.hostname = &quot;npm.elemecdn.com&quot;;</span><br><span class="line">    url.port = &quot;&quot;;</span><br><span class="line">    var path = url.pathname;</span><br><span class="line">    url.pathname = &quot;你的博客镜像包名@1.0.000919&quot; + path;</span><br><span class="line">    console.log(url);</span><br><span class="line">    var url = url.toString();</span><br><span class="line">    console.log(url);</span><br><span class="line">    let options = &#123;</span><br><span class="line">      redirect: &#x27;follow&#x27;</span><br><span class="line">    &#125;;</span><br><span class="line">    let request = new Request(url, options);</span><br><span class="line">    event.respondWith(fetch(request));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>这时候npmversionupdata.js的代码应该为</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">var fs = require(&#x27;fs&#x27;);</span><br><span class="line">var timestamp=new Date().getTime()</span><br><span class="line">function changeJson(timestamp)&#123;</span><br><span class="line">    fs.readFile(&#x27;package.json&#x27;,function(err,data)&#123;</span><br><span class="line">        if(err)&#123;</span><br><span class="line">            console.error(err);</span><br><span class="line">        &#125;</span><br><span class="line">        var person = data.toString();</span><br><span class="line">        person = JSON.parse(person);</span><br><span class="line">        person.version = &quot;1.0.&quot; + timestamp</span><br><span class="line">        var str = JSON.stringify(person);</span><br><span class="line">        fs.writeFile(&#x27;package.json&#x27;,str,function(err)&#123;</span><br><span class="line">            if(err)&#123;</span><br><span class="line">                console.error(err);</span><br><span class="line">            &#125;</span><br><span class="line">            console.log(&#x27;修改成功&#x27;);</span><br><span class="line">            console.log(person.version);</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line">function changejs(timestamp) &#123;</span><br><span class="line">    fs.readFile(&#x27;sw.js&#x27;,&#x27;utf8&#x27;,function(err,files)&#123;</span><br><span class="line">        var result = files.replace(/1.0.000919/g,&quot;1.0.&quot; + timestamp);</span><br><span class="line">        console.log(&quot;ok&quot;)</span><br><span class="line">        fs.writeFile(&#x27;sw.js&#x27;, result, &#x27;utf8&#x27;, function (err) &#123;</span><br><span class="line">             if (err) return console.log(err);</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">    &#125;)</span><br><span class="line">&#125;;</span><br><span class="line">changeJson(timestamp)</span><br><span class="line">changejs(timestamp)</span><br></pre></td></tr></table></figure><p>然后我们为了启用sw.js我们需要在要使用的页面插入以下代码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">navigator.serviceWorker.getRegistration().then(function(registration) &#123;</span><br><span class="line">  if (registration) &#123;</span><br><span class="line">    // Service worker is already registered</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    // Service worker is not registered, so we need to register it</span><br><span class="line">    navigator.serviceWorker.register(&#x27;/sw.js&#x27;)</span><br><span class="line">      .then(function(registration) &#123;</span><br><span class="line">        window.location.reload();</span><br><span class="line">        // Service worker is now registered</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>你可以自己创建一个js并引入（通过hexo官方的api）最好是插入到每个页面的最前面这样效果更好注册器例如</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo.extend.injector.register(entry, value, to)</span><br></pre></td></tr></table></figure><p>官方链接：<a href="https://hexo.io/zh-cn/api/injector">注入器（Injector） | Hexo</a></p><h1 id="通过clientworker分流到npm国内镜像（推荐）"><a href="#通过clientworker分流到npm国内镜像（推荐）" class="headerlink" title="通过clientworker分流到npm国内镜像（推荐）"></a>通过clientworker分流到npm国内镜像（推荐）</h1><h2 id="创建配置文件"><a href="#创建配置文件" class="headerlink" title="创建配置文件"></a>创建配置文件</h2><h3 id="我自用的"><a href="#我自用的" class="headerlink" title="我自用的"></a>我自用的</h3><p>在博客根目录的source文件夹下创建config.yaml（hexo要跳过编译此文件）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">name: ClientWorker Docs Config</span><br><span class="line">cleaninterval: 1000*20 # 每20秒检测并清理一次</span><br><span class="line"></span><br><span class="line">catch_rules: #转换规则</span><br><span class="line">    - rule: _ #ClientWorker语法糖，匹配当前域，返回一个域名带端口</span><br><span class="line">      transform_rules: #转换规则，最上面的优先最高</span><br><span class="line">        - search: \#.* #在发送请求时匹配#后内容并移除</span><br><span class="line">          replace: &#x27;&#x27;</span><br><span class="line"></span><br><span class="line">        - search: \?.* #在发送请求时匹配?后内容并移除，仅限静态请求</span><br><span class="line">          replace: &#x27;&#x27;</span><br><span class="line"></span><br><span class="line">        - search: ([^\/.]+)\/$</span><br><span class="line">          replace: $1/index.html</span><br><span class="line">  </span><br><span class="line">        - search: _ </span><br><span class="line">          replace: </span><br><span class="line">          - _ </span><br><span class="line">          - npm.elemecdn.com/你的npm分流包名称@1.0.000919</span><br><span class="line">          - npm.sourcegcdn.com/你的npm分流包名称@1.0.000919</span><br><span class="line">          - blogcf.abeginner.cn</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        - search: haorblog\.adhy\.cc</span><br><span class="line">          action: skip</span><br><span class="line"></span><br><span class="line">        - search: https:\/\/blog.abeginner.cn\/false</span><br><span class="line">          action: return</span><br><span class="line">          redirect: </span><br><span class="line">            status: 404</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        - search: \.html$</span><br><span class="line">          header:</span><br><span class="line">            Content-Type: text/html;charset=UTF-8 #修复标头</span><br><span class="line"></span><br><span class="line">        - search: _</span><br><span class="line">          action: fetch</span><br><span class="line">          fetch:</span><br><span class="line">            status: 200</span><br><span class="line">            engine: parallel</span><br><span class="line">            preflight: false</span><br><span class="line">            timeout: 5000</span><br><span class="line">            cache:</span><br><span class="line">              expire: 1000*60*60*8</span><br><span class="line">              delay: 200</span><br></pre></td></tr></table></figure><h3 id="调试出你自己的"><a href="#调试出你自己的" class="headerlink" title="调试出你自己的"></a>调试出你自己的</h3><p>官方文档：<a href="https://clientworker.js.org/start.html">快速开始 | ClientWorker</a></p><h2 id="载入clientworker"><a href="#载入clientworker" class="headerlink" title="载入clientworker"></a>载入clientworker</h2><p>去官方网址下载压缩包，官方链接：<a href="https://github.com/ChenYFan/ClientWorker/releases">https://github.com/ChenYFan/ClientWorker/releases</a></p><p>拷贝其中的cw.js到hexo根目录的source文件夹下，为了避免不必要的错误，gulp请不要打包它</p><h2 id="引用cw"><a href="#引用cw" class="headerlink" title="引用cw"></a>引用cw</h2><p>官方开始文档：<a href="https://clientworker.js.org/start.html#step-3-%E9%85%8D%E7%BD%AE%E5%AE%89%E8%A3%85%E4%BB%A3%E7%A0%81-%E6%9C%80%E5%90%8E%E4%B8%80%E6%AD%A5%E4%BA%86%EF%BC%8C%E5%8A%A0%E6%B2%B9%EF%BC%81">快速开始 | ClientWorker</a></p><p>选择自己的引入方式可以直接通过主题的配置文件插入也可以单独写一个js并用hexo的api引入</p><p>hexoapi官方文档：<a href="https://hexo.io/zh-cn/api/injector">注入器（Injector） | Hexo</a></p><h2 id="自动更新npm版本"><a href="#自动更新npm版本" class="headerlink" title="自动更新npm版本"></a>自动更新npm版本</h2><p>使用文章开头的npmversionupdata.js就行了</p><h1 id="可能遇到的错误"><a href="#可能遇到的错误" class="headerlink" title="可能遇到的错误"></a>可能遇到的错误</h1><ol><li>文件位置没有放正确</li><li>文件名不对（你可以根据自己的需要更改文件名，他们之间有依赖关系）</li><li>node版本不正确和npm源问题</li><li>github action脚本缩进问题</li></ol><h1 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h1><p>这样你就可以得到一个快速的，相当于免费使用国内服务器的博客啦，希望这篇博客能对你有帮助</p><p>谢谢阅读，如果有问题可以在评论区评论</p>]]></content>
      
      
      <categories>
          
          <category> 经验分享 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>使用多方法给hexo加速</title>
      <link href="/2022/12/04/%E4%BD%BF%E7%94%A8%E5%A4%9A%E6%96%B9%E6%B3%95%E7%BB%99hexo%E5%8A%A0%E9%80%9F/"/>
      <url>/2022/12/04/%E4%BD%BF%E7%94%A8%E5%A4%9A%E6%96%B9%E6%B3%95%E7%BB%99hexo%E5%8A%A0%E9%80%9F/</url>
      
        <content type="html"><![CDATA[<p>在主题的script文件夹创建modify.js</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line">&#x27;use strict&#x27;;</span><br><span class="line">const &#123; filter &#125; = hexo.extend;</span><br><span class="line"></span><br><span class="line">// 替换 CDN</span><br><span class="line">filter.register(&#x27;before_generate&#x27;, () =&gt; &#123;</span><br><span class="line">    const &#123; asset &#125; = hexo.theme.config;</span><br><span class="line">    for (const name in asset) &#123;</span><br><span class="line">        asset[name] = asset[name].replace(&#x27;//cdn.jsdelivr.net/npm/&#x27;, &#x27;//npm.elemecdn.com/&#x27;);</span><br><span class="line">        asset[name] = asset[name].replace(&#x27;https://cdn.jsdelivr.net/gh/Zfour/Butterfly-double-row-display@1.00/cardlistpost.min.css&#x27;, &#x27;https://haorblog.adhy.cc/blogimg/cardlistpost.min.css&#x27;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;, 11);</span><br><span class="line"></span><br><span class="line">//通用注入器</span><br><span class="line">//name 注入插件名称</span><br><span class="line">//item_comfig 注入插件的配置名</span><br><span class="line">//temple_html_text 注入插件的挂载html模板(带有用户自定义的html/js/css)</span><br><span class="line">//js_text 注入js</span><br><span class="line">//css_text 注入css</span><br><span class="line"></span><br><span class="line">function common_injector(name, item_comfig, temple_html_text, js_text, css_text) &#123;</span><br><span class="line">    if (item_comfig.enable) &#123;</span><br><span class="line">        if (temple_html_text !== &#x27;&#x27;) &#123;</span><br><span class="line">            var layout_name;</span><br><span class="line">            var layout_type;</span><br><span class="line">            var layout_index = 0;</span><br><span class="line">            if (item_comfig.layout_id) &#123;</span><br><span class="line">                layout_name = item_comfig.layout_id;</span><br><span class="line">                layout_type = &#x27;id&#x27;;</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                layout_name = item_comfig.layout.name;</span><br><span class="line">                layout_type = item_comfig.layout.type;</span><br><span class="line">                layout_index = item_comfig.layout.index;</span><br><span class="line">            &#125;</span><br><span class="line">            var get_layout</span><br><span class="line">            if (layout_type === &#x27;class&#x27;) &#123;</span><br><span class="line">                get_layout = `document.getElementsByClassName(&#x27;$&#123;layout_name&#125;&#x27;)[$&#123;layout_index&#125;]`</span><br><span class="line">            &#125; else if (layout_type === &#x27;id&#x27;) &#123;</span><br><span class="line">                get_layout = `document.getElementById(&#x27;$&#123;layout_name&#125;&#x27;)`</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                get_layout = `document.getElementById(&#x27;$&#123;layout_name&#125;&#x27;)`</span><br><span class="line">            &#125;</span><br><span class="line">            var user_info_js = `&lt;script data-pjax&gt;function $&#123;name&#125;_injector_config()&#123;</span><br><span class="line">                var parent_div_git = $&#123;get_layout&#125;;</span><br><span class="line">                var item_html = &#x27;$&#123;temple_html_text&#125;&#x27;;</span><br><span class="line">                console.log(&#x27;已挂载$&#123;name&#125;&#x27;)</span><br><span class="line">                // parent_div_git.innerHTML=item_html+parent_div_git.innerHTML // 无报错，但不影响使用(支持pjax跳转)</span><br><span class="line">                parent_div_git.insertAdjacentHTML(&quot;afterbegin&quot;,item_html) // 有报错，但不影响使用(支持pjax跳转)</span><br><span class="line">            &#125;if( $&#123;get_layout&#125; &amp;&amp; location.pathname ===&#x27;$&#123;item_comfig.enable_page&#125;&#x27;)&#123;</span><br><span class="line"></span><br><span class="line">            common_injector_config()</span><br><span class="line">        &#125; &lt;/script&gt;`</span><br><span class="line">        &#125;</span><br><span class="line">        hexo.extend.injector.register(&#x27;body_end&#x27;, user_info_js, &quot;default&quot;);</span><br><span class="line">        if (js_text !== &#x27;&#x27;) &#123;</span><br><span class="line">            hexo.extend.injector.register(&#x27;body_end&#x27;, js_text, &quot;default&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">        if (css_text !== &#x27;&#x27;) &#123;</span><br><span class="line">            hexo.extend.injector.register(&#x27;head_end&#x27;, css_text, &quot;default&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">hexo.extend.filter.register(&#x27;after_generate&#x27;,function() &#123;</span><br><span class="line">    if(hexo.config.butterfly_article_double_row_new.enable)&#123;</span><br><span class="line">        var butterfly_article_double_row_comfig = hexo.config.butterfly_article_double_row_new;</span><br><span class="line">        var css_text =`&lt;link rel=&quot;stylesheet&quot; href=&quot;https://haorblog.adhy.cc/blogimg/cardlistpost.min.css&quot;/&gt;</span><br><span class="line">&lt;style&gt;#recent-posts &gt; .recent-post-item &gt;.recent-post-info &gt; .article-meta-wrap &gt; .tags:before &#123;content:&quot;\\A&quot;;</span><br><span class="line">  white-space: pre;&#125;#recent-posts &gt; .recent-post-item &gt;.recent-post-info &gt; .article-meta-wrap &gt; .tags &gt; .article-meta__separator&#123;display:none&#125;&lt;/style&gt;</span><br><span class="line">`</span><br><span class="line"></span><br><span class="line">        common_injector(&#x27;butterfly_article_double_row&#x27;, butterfly_article_double_row_comfig, &#x27;&#x27;, &#x27;&#x27;, css_text)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;)</span><br><span class="line">const js = hexo.extend.helper.get(&#x27;js&#x27;).bind(hexo);</span><br><span class="line">hexo.extend.injector.register(&#x27;head_begin&#x27;, () =&gt; &#123;return js(&#x27;/js/clientworker.js&#x27;);&#125;);</span><br><span class="line">hexo.extend.injector.register(&#x27;head_begin&#x27;, () =&gt; &#123;return js(&#x27;/js/autoupdate.js&#x27;);&#125;);</span><br></pre></td></tr></table></figure><p>中间那一段是为了指定cardlistpost的链接因为我用的是qexo所以编译都是在vercel github cloudflare进行的，我没有办法指定他的css引入链接于是就重写到这里来了</p><p>在博客根目录_config.yml做以下修改</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">butterfly_article_double_row:</span><br><span class="line">  enable: false</span><br><span class="line">butterfly_article_double_row_new:</span><br><span class="line">  enable: true</span><br></pre></td></tr></table></figure><p>然后就是指定某些依赖项的链接（对于butterfly主题，主题的_config.yml做以下更改）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">CDN:</span><br><span class="line">  # The CDN provider of internal scripts (主題內部 js 的 cdn 配置)</span><br><span class="line">  # option: local/jsdelivr/unpkg/cdnjs/custom</span><br><span class="line">  # Dev version can only choose. ( dev版的主題只能設置為 local )</span><br><span class="line">  internal_provider: local</span><br><span class="line"></span><br><span class="line">  # The CDN provider of third party scripts (第三方 js 的 cdn 配置)</span><br><span class="line">  # option: local/jsdelivr/unpkg/cdnjs/custom</span><br><span class="line">  # when set it to local, you need to install hexo-butterfly-extjs</span><br><span class="line">  third_party_provider: jsdelivr</span><br><span class="line"></span><br><span class="line">  # Add version number to CDN, true or false  </span><br><span class="line">  version: false</span><br><span class="line"></span><br><span class="line">  # Custom format</span><br><span class="line">  # For example: https://cdn.staticfile.org/$&#123;cdnjs_name&#125;/$&#123;version&#125;/$&#123;min_cdnjs_file&#125;</span><br><span class="line">  custom_format:</span><br><span class="line"></span><br><span class="line">  option:</span><br><span class="line">    jquery: https://haorblog.adhy.cc/blogimg/jquery.min.js</span><br><span class="line">    pjax: https://haorblog.adhy.cc/blogimg/pjax.min.js</span><br><span class="line">    lazyload: https://haorblog.adhy.cc/blogimg/lazyload.iife.min.js</span><br><span class="line">    instantpage: https://haorblog.adhy.cc/blogimg/instantpage.min.js</span><br><span class="line">    fontawesomeV6: https://cdn.staticfile.org/font-awesome/6.2.0/css/all.min.css #https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/font-awesome/6.0.0/css/all.min.css</span><br><span class="line">    snackbar_css: https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/node-snackbar/0.1.16/snackbar.min.css</span><br><span class="line">    snackbar: https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/node-snackbar/0.1.16/snackbar.min.js</span><br><span class="line">    fancybox_css_v4: https://haorblog.adhy.cc/blogimg/fancybox.min.css</span><br><span class="line">    fancybox_v4: https://haorblog.adhy.cc/blogimg/fancybox.umd.min.js</span><br><span class="line">    countup_js: /js/countup.js</span><br></pre></td></tr></table></figure><p>然后给你的博客配置上clientworker（基于service worker的一个模块）来颗粒化控制缓存还有前端并发</p><p>在博客source文件夹下按照clientworker.js.org里写的放入cw.js还有config.yaml在主题的source/js下放入autoupdate.js</p><p>以及clientworker.js</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">if (!!navigator.serviceWorker) &#123;</span><br><span class="line">    if (localStorage.getItem(&#x27;cw_installed&#x27;) !== &#x27;true&#x27;) &#123;window.stop();&#125;</span><br><span class="line">    navigator.serviceWorker.register(&#x27;/cw.js?t=&#x27; + new Date().getTime()).then(async (registration) =&gt; &#123;</span><br><span class="line">        if (localStorage.getItem(&#x27;cw_installed&#x27;) !== &#x27;true&#x27;) &#123;</span><br><span class="line">            const conf = () =&gt; &#123;</span><br><span class="line">                console.log(&#x27;[CW] Installing Success,Configuring...&#x27;);</span><br><span class="line">                fetch(&#x27;/cw-cgi/api?type=config&#x27;)</span><br><span class="line">                    .then(res =&gt; res.text())</span><br><span class="line">                    .then(text =&gt; &#123;</span><br><span class="line">                        if (text === &#x27;ok&#x27;) &#123;</span><br><span class="line">                            console.log(&#x27;[CW] Installing Success,Configuring Success,Starting...&#x27;);</span><br><span class="line">                            localStorage.setItem(&#x27;cw_installed&#x27;, &#x27;true&#x27;);</span><br><span class="line">                            window.location.reload();</span><br><span class="line">                        &#125; else &#123;</span><br><span class="line">                            console.warn(&#x27;[CW] Installing Success,Configuring Failed,Sleeping 200ms...&#x27;);</span><br><span class="line">                            setTimeout(() =&gt; &#123;</span><br><span class="line">                                conf()</span><br><span class="line">                            &#125;, 200);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;).catch(err =&gt; &#123;</span><br><span class="line">                        console.log(&#x27;[CW] Installing Success,Configuring Error,Exiting...&#x27;);</span><br><span class="line">                    &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">            setTimeout(() =&gt; &#123;</span><br><span class="line">                conf()</span><br><span class="line">            &#125;, 50);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;).catch(err =&gt; &#123;</span><br><span class="line">        console.error(&#x27;[CW] Installing Failed,Error: &#x27; + err.message);</span><br><span class="line">    &#125;)</span><br><span class="line">&#125; else &#123; console.error(&#x27;[CW] Installing Failed,Error: Browser not support service worker&#x27;); &#125;</span><br></pre></td></tr></table></figure><p>引入这两个文件的代码在modify.js的最后两行可以根据自己的路径更改</p><p>cw的配置文件（自用）</p><p>config.yaml</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">catch_rules: #转换规则</span><br><span class="line">    - rule: _ #ClientWorker语法糖，匹配当前域，返回一个域名带端口</span><br><span class="line">      transform_rules: #转换规则，最上面的优先最高</span><br><span class="line">        - search: \#.* #在发送请求时匹配#后内容并移除</span><br><span class="line">          replace: &#x27;&#x27;</span><br><span class="line"></span><br><span class="line">        - search: \?.* #在发送请求时匹配?后内容并移除，仅限静态请求</span><br><span class="line">          replace: &#x27;&#x27;</span><br><span class="line"></span><br><span class="line">        - search: ([^\/.]+)\/$</span><br><span class="line">          replace: $1/index.html</span><br><span class="line">  </span><br><span class="line">        - search: _ </span><br><span class="line">          replace: </span><br><span class="line">          - _ </span><br><span class="line">          - npm.elemecdn.com/haor-blog-main</span><br><span class="line">          - blogcf.abeginner.cn</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        - search: haorblog\.adhy\.cc</span><br><span class="line">          action: skip</span><br><span class="line"></span><br><span class="line">        - search: https:\/\/blog.abeginner.cn\/false</span><br><span class="line">          action: return</span><br><span class="line">          redirect: </span><br><span class="line">            status: 404</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        - search: \.html$</span><br><span class="line">          header:</span><br><span class="line">            Content-Type: text/html;charset=UTF-8 #修复标头</span><br><span class="line"></span><br><span class="line">        - search: _</span><br><span class="line">          action: fetch</span><br><span class="line">          fetch:</span><br><span class="line">            status: 200</span><br><span class="line">            engine: parallel</span><br><span class="line">            preflight: false</span><br><span class="line">            timeout: 5000</span><br><span class="line">            cache:</span><br><span class="line">              expire: 1000*60*60*8</span><br><span class="line">              delay: 200</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>如果你不上传博客代码到npm可以把中间的npm.elemecdn.com/haor-blog-main去掉</p><h1 id="使用github-action上传博客源码到npm"><a href="#使用github-action上传博客源码到npm" class="headerlink" title="使用github action上传博客源码到npm"></a>使用github action上传博客源码到npm</h1><p>在博客根目录创建.github/workflows/autopublish.yml注意是.github</p><p>代码为</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">name: 自动部署</span><br><span class="line"></span><br><span class="line">on:</span><br><span class="line">  push:</span><br><span class="line">    branches:</span><br><span class="line">      - master</span><br><span class="line"></span><br><span class="line">jobs:</span><br><span class="line">  my_first_job:</span><br><span class="line">    name: my first job</span><br><span class="line">    runs-on: ubuntu-latest</span><br><span class="line">    steps:</span><br><span class="line">      - name: 检查分支</span><br><span class="line">        uses: actions/checkout@v2</span><br><span class="line">        with:</span><br><span class="line">          ref: master</span><br><span class="line"></span><br><span class="line">      - name: 安装 Node</span><br><span class="line">        uses: actions/setup-node@v1</span><br><span class="line">        with:</span><br><span class="line">          node-version: &quot;16.x&quot;</span><br><span class="line">          registry-url: https://registry.npmjs.org/</span><br><span class="line"></span><br><span class="line">      - name: 安装 Hexo</span><br><span class="line">        run: |</span><br><span class="line">          export TZ=&#x27;Asia/Shanghai&#x27;</span><br><span class="line">          npm install hexo-cli -g</span><br><span class="line"></span><br><span class="line">      - name: 缓存 Hexo</span><br><span class="line">        id: cache-npm</span><br><span class="line">        uses: actions/cache@v3</span><br><span class="line">        env:</span><br><span class="line">          cache-name: cache-node-modules</span><br><span class="line">        with:</span><br><span class="line">          path: node_modules</span><br><span class="line">          key: $&#123;&#123; runner.os &#125;&#125;-build-$&#123;&#123; env.cache-name &#125;&#125;-$&#123;&#123; hashFiles(&#x27;**/package-lock.json&#x27;) &#125;&#125;</span><br><span class="line">          restore-keys: |</span><br><span class="line">            $&#123;&#123; runner.os &#125;&#125;-build-$&#123;&#123; env.cache-name &#125;&#125;-</span><br><span class="line">            $&#123;&#123; runner.os &#125;&#125;-build-</span><br><span class="line">            $&#123;&#123; runner.os &#125;&#125;-</span><br><span class="line"></span><br><span class="line">      - name: 安装依赖</span><br><span class="line">        if: $&#123;&#123; steps.cache-npm.outputs.cache-hit != &#x27;true&#x27; &#125;&#125;</span><br><span class="line">        run: |</span><br><span class="line">          npm install --save</span><br><span class="line"></span><br><span class="line">      - name: 生成静态文件</span><br><span class="line">        run: |</span><br><span class="line">          hexo generate</span><br><span class="line"></span><br><span class="line">      - name: 推送到npm镜像</span><br><span class="line">        run: |</span><br><span class="line">          cd public</span><br><span class="line">          node npmversionupdata.js</span><br><span class="line">          npm publish</span><br><span class="line">        env:</span><br><span class="line">          NODE_AUTH_TOKEN: $&#123;&#123;secrets.npm_token&#125;&#125;</span><br></pre></td></tr></table></figure><p>然后在仓库里添加<code>secrets</code>：NPM_TOKEN值为你自己的npm_token</p><h2 id="解决npm覆盖版本报错的问题"><a href="#解决npm覆盖版本报错的问题" class="headerlink" title="解决npm覆盖版本报错的问题"></a>解决npm覆盖版本报错的问题</h2><p>在博客source目录运行npm init生成package.json版本随便</p><p>然后在source目录创建npmversionupdata.js使用时间控制你的npm包版本</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">var fs = require(&#x27;fs&#x27;);</span><br><span class="line">var timestamp=new Date().getTime()</span><br><span class="line">function changeJson(timestamp)&#123;</span><br><span class="line">    fs.readFile(&#x27;package.json&#x27;,function(err,data)&#123;</span><br><span class="line">        if(err)&#123;</span><br><span class="line">            console.error(err);</span><br><span class="line">        &#125;</span><br><span class="line">        var person = data.toString();</span><br><span class="line">        person = JSON.parse(person);</span><br><span class="line">        person.version = &quot;1.0.&quot; + timestamp</span><br><span class="line">        var str = JSON.stringify(person);</span><br><span class="line">        fs.writeFile(&#x27;package.json&#x27;,str,function(err)&#123;</span><br><span class="line">            if(err)&#123;</span><br><span class="line">                console.error(err);</span><br><span class="line">            &#125;</span><br><span class="line">            console.log(&#x27;修改成功&#x27;);</span><br><span class="line">            console.log(person.version);</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line">function changeconfig(timestamp) &#123;</span><br><span class="line">    fs.readFile(&#x27;config.yaml&#x27;,&#x27;utf8&#x27;,function(err,files)&#123;</span><br><span class="line">        var result = files.replace(/1.0.000919/g,&quot;1.0.&quot; + timestamp);</span><br><span class="line">        console.log(&quot;ok&quot;)</span><br><span class="line">        fs.writeFile(&#x27;config.yaml&#x27;, result, &#x27;utf8&#x27;, function (err) &#123;</span><br><span class="line">             if (err) return console.log(err);</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">    &#125;)</span><br><span class="line">&#125;;</span><br><span class="line">changeJson(timestamp)</span><br><span class="line">changeconfig(timestamp)</span><br></pre></td></tr></table></figure><p>然后在cw的配置项里把blogcf.abeginner.cn和npm.elemecdn.com的那个换成你的分流站和自己的npm包镜像地址</p><p>无了………</p>]]></content>
      
      
      <categories>
          
          <category> 经验分享 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>vercel部署yesplaymusic报错解决</title>
      <link href="/2022/11/30/30/"/>
      <url>/2022/11/30/30/</url>
      
        <content type="html"><![CDATA[<h1 id="错误"><a href="#错误" class="headerlink" title="错误"></a>错误</h1><p>error @achrinza/node-<a href="https://link.juejin.cn/?target=mailto:ipc@9.2.2" title="mailto:ipc@9.2.2">ipc@9.2.2</a>: The engine “node” is incompatible with this module. Expected version “8 || 10 || 12 || 14 || 16 || 17”. Got “18.9.0”</p><h1 id="原因"><a href="#原因" class="headerlink" title="原因"></a>原因</h1><p>该项目环境不支持<code>node@18.9.0</code>版本，需要降级到 <strong>8 || 10 || 12 || 14 || 16 || 17</strong> 版本</p><h1 id="解决"><a href="#解决" class="headerlink" title="解决"></a>解决</h1><p>回到你的vercel控制面板，打开刚刚部署报错的yesplaymusic项目，点setting-&gt;general-&gt;Node.js Version 选择16.x</p>]]></content>
      
      
      <categories>
          
          <category> 经验分享 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>vercel电信的线路又断断续续五分钟</title>
      <link href="/2022/11/23/vercel%E5%8F%88%E5%87%BA%E9%97%AE%E9%A2%98%E4%BA%86/"/>
      <url>/2022/11/23/vercel%E5%8F%88%E5%87%BA%E9%97%AE%E9%A2%98%E4%BA%86/</url>
      
        <content type="html"><![CDATA[<p>就在今天下午八点左右，我部署在vercel上的博客又无法访问了（我是电信网）itdog测试后发现还是只有电信不稳定</p><p><a href="https://imgse.com/i/z8Tuzn"><img src="https://s1.ax1x.com/2022/11/23/z8Tuzn.png" alt="z8Tuzn.png"></a><br><a href="https://imgse.com/i/z8TnRs"><img src="https://s1.ax1x.com/2022/11/23/z8TnRs.png" alt="z8TnRs.png"></a></p><p>联通移动都没有问题，还是只持续了五分钟左右</p>]]></content>
      
      
      <categories>
          
          <category> 经验分享 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>用cloudflare pages搭建你的博客</title>
      <link href="/2022/11/23/2022112302/"/>
      <url>/2022/11/23/2022112302/</url>
      
        <content type="html"><![CDATA[<p>cloudflare推出了一项新的服务cloudflare pages（感觉最近cloudflare上新好快😃 ）他可以直接上传静态文件，也可以git你的github仓库之类的，网上用它直接上传文件搭建博客的教程有很多，但是cloudflare这么人性化的厂商，那么多的功能，直接上传文件搭建博客的，未免有点小题大做了，刚好先前我的博客是搭建在vercel的，还使用了qexo，上传文章还会自动部署，随时随地写文章，非常的人性化🙂 ，然后我就想到，cloudflare也会自动部署，还能执行自定义命令，虽然他的预设框架里没有hexo，但是我们可以使用自定义命令让他支持hexo，首先，像qexo部署博客一样上传那三个最重要的文件夹还有其他东西，上传到github然后绑定仓库，这里就不细说了，不会的可以去看qexo作者啊不都的文章，然后打开设置调整为下图所示的样子</p><p><img src="https://haorblog.adhy.cc/blogimg/cfhexo03.PNG"></p><p>分支就是你代码所在的分支</p><p>构建命令：<code>npm install hexo@5.4.2 -g;npm install;hexo g</code></p><p>构建输出目录：<code>public</code></p><p>这样你一用qexo写文章vercel会自动部署，cloudflare也会啦，可以拿cloudflare当个备站，因为vercel最近老师不稳定</p>]]></content>
      
      
      <categories>
          
          <category> 经验分享 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>我发现一件很神奇的事情,hexo@6.3.0部署我现在版本的博客会出错</title>
      <link href="/2022/11/23/2022112301/"/>
      <url>/2022/11/23/2022112301/</url>
      
        <content type="html"><![CDATA[<p>我在cloudflare pages上部署hexo的时候，原先是直接执行<code>npm intsall hexo -g</code>安装hexo的，但是他这时默认安装的就是最新版本<code>6.3.0</code>然后部署我现在的博客就会有一大堆错误，如图</p><p><img src="https://haorblog.adhy.cc/blogimg/cfhexo.PNG"></p><p><img src="https://haorblog.adhy.cc/blogimg/cfhexo01.PNG"></p><p>（看侧边的滚动条就知道报了多少错）可以显示index.html但是点进去文章啥也没有（看过控制台，就是没渲染post），主题是butterfly（魔改过的）他提示post.styl错误，但是我回退版本至<code>5.4.2</code>就不会报错了，可能是因为版本太高了不支持？，日后再看看，现在记录一下我在云ide正常使用的hexo各项版本<code>hexo v</code>显示的</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">hexo-cli: 4.3.0</span><br><span class="line">os: linux 4.19.126-1.jdcloud.x86_64 Ubuntu 20.04.4 LTS (Focal Fossa)</span><br><span class="line">node: 16.16.0</span><br><span class="line">v8: 9.4.146.24-node.21</span><br><span class="line">uv: 1.43.0</span><br><span class="line">zlib: 1.2.11</span><br><span class="line">brotli: 1.0.9</span><br><span class="line">ares: 1.18.1</span><br><span class="line">modules: 93</span><br><span class="line">nghttp2: 1.47.0</span><br><span class="line">napi: 8</span><br><span class="line">llhttp: 6.0.7</span><br><span class="line">openssl: 1.1.1q+quic</span><br><span class="line">cldr: 40.0</span><br><span class="line">icu: 70.1</span><br><span class="line">tz: 2021a3</span><br><span class="line">unicode: 14.0</span><br><span class="line">ngtcp2: 0.1.0-DEV</span><br><span class="line">nghttp3: 0.1.0-DEV</span><br></pre></td></tr></table></figure><p>ide是csdn的，现在去领取还能免费给你一年，就是去gitcode（csdn自己搞得类似gitee,github之类的东西）做一个非常easy的fork操作</p>]]></content>
      
      
      <categories>
          
          <category> 经验分享 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>vercel不知怎么了最近老是不稳定</title>
      <link href="/2022/11/22/vercel%E4%B8%8D%E7%9F%A5%E6%80%8E%E4%B9%88%E4%BA%86%E6%9C%80%E8%BF%91%E8%80%81%E6%98%AF%E4%B8%8D%E7%A8%B3%E5%AE%9A/"/>
      <url>/2022/11/22/vercel%E4%B8%8D%E7%9F%A5%E6%80%8E%E4%B9%88%E4%BA%86%E6%9C%80%E8%BF%91%E8%80%81%E6%98%AF%E4%B8%8D%E7%A8%B3%E5%AE%9A/</url>
      
        <content type="html"><![CDATA[<p>从昨天晚上凌晨一点多左右，发现我的网站突然访问不了了，然后用itdog测试了一下，发现电信的节点濒临崩溃，基本上都是丢包百分之百 而联通移动则没有问题，就在中午又发生了一次，同样是联通移动没有问题，因为vercel是anycast节点，同一节点解析到联通移动都没有问题，整个过程只持续了五分钟便恢复了正常，应该不是被攻击</p>]]></content>
      
      
      <categories>
          
          <category> 闲得无聊 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>用qexo上传文章的时候文件名重和了，导致我直接损失一篇文章</title>
      <link href="/2022/11/22/post/"/>
      <url>/2022/11/22/post/</url>
      
        <content type="html"><![CDATA[<p>记一次错误，一次写文章的时候，文章的文件名跟我之前发布的一篇文章的文件名字重合了，本以为他会加个（2）之类的，结果他直接把我之前那篇文章覆盖了，辛亏vercel还能找到以前的推送</p>]]></content>
      
      
      <categories>
          
          <category> 经验分享 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>解决butterfly访问速度慢的问题</title>
      <link href="/2022/11/22/1/"/>
      <url>/2022/11/22/1/</url>
      
        <content type="html"><![CDATA[<p>原先我觉得我博客慢是因为我的源站延迟高，带宽小，因为没备案的缘故使用不了国内的cdn，我也没办法备案，之前也用过vercel，感觉速度还是慢，于是我打开控制台仔细琢磨了一下，发现butterfly有大量的依赖，那些依赖的源都是jsdelivr的，之前确实挺快的，但是现在jsdelivr的备案掉了，国内访问会被指向国外的节点，因为绕路的原因，速度并不好，于是我就去网上找了更改这些依赖链接的方法，这是我更改后的速度</p><p><img src="https://haorblog.adhy.cc/blogimg/11111.PNG" alt="11111.PNG"></p><p>访客看到加载动画结束后的画面大概一秒多，源站是vercel的，还可以部署个qexo随时随地写文章</p><h1 id="个别项更改"><a href="#个别项更改" class="headerlink" title="个别项更改"></a>个别项更改</h1><p>修改主题配置文件，找到cdn的option这一项改为</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">option:</span><br><span class="line">    pjax: https://lib.baomitu.com/pjax/0.2.8/pjax.min.js</span><br><span class="line">    lazyload: https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/vanilla-lazyload/17.3.1/lazyload.iife.min.js</span><br><span class="line">    instantpage: https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/instant.page/5.1.0/instantpage.min.js</span><br><span class="line">    fontawesomeV6: https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/font-awesome/6.0.0/css/all.min.css</span><br><span class="line">    snackbar_css: https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/node-snackbar/0.1.16/snackbar.min.css</span><br><span class="line">    snackbar: https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/node-snackbar/0.1.16/snackbar.min.js</span><br></pre></td></tr></table></figure><p><code>fancybox_css_v4</code>和<code>fancybox_v4</code>需要自己访问jsdelivr下载上传到自己的cdn上格式跟上面一样（老的butterfly写fancybox，我的是4.5的所以写fancybox_v4），接下来就是批量的把其他的jsdelivr链接改为饿了么的cdn（虽然我也不知道为什么饿了么会有这个cdn，网上找到的）</p><p>在主题的script文件夹下新建一个js文件，名字随便代码如下</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line">&#x27;use strict&#x27;;</span><br><span class="line">const &#123; filter &#125; = hexo.extend;</span><br><span class="line"></span><br><span class="line">// 替换 CDN</span><br><span class="line">filter.register(&#x27;before_generate&#x27;, () =&gt; &#123;</span><br><span class="line">    const &#123; asset &#125; = hexo.theme.config;</span><br><span class="line">    for (const name in asset) &#123;</span><br><span class="line">        asset[name] = asset[name].replace(&#x27;//cdn.jsdelivr.net/npm/&#x27;, &#x27;//npm.elemecdn.com/&#x27;);</span><br><span class="line">        //asset[name] = asset[name].replace(&#x27;https://cdn.jsdelivr.net/gh/Zfour/Butterfly-double-row-display@1.00/cardlistpost.min.css&#x27;, &#x27;https://haorblog.adhy.cc/blogimg/cardlistpost.min.css&#x27;);</span><br><span class="line">    &#125;</span><br><span class="line">    //const &#123; blog_cdn &#125; = hexo.config.butterfly_article_double_row</span><br><span class="line">    //hexo.config.butterfly_article_double_row = blog_cdn.replace(&#x27;https://cdn.jsdelivr.net/gh/Zfour/Butterfly-double-row-display@1.00/cardlistpost.min.css&#x27;, &#x27;https://haorblog.adhy.cc/blogimg/cardlistpost.min.css&#x27;);</span><br><span class="line">&#125;, 11);</span><br><span class="line"></span><br><span class="line">//通用注入器</span><br><span class="line">//name 注入插件名称</span><br><span class="line">//item_comfig 注入插件的配置名</span><br><span class="line">//temple_html_text 注入插件的挂载html模板(带有用户自定义的html/js/css)</span><br><span class="line">//js_text 注入js</span><br><span class="line">//css_text 注入css</span><br><span class="line"></span><br><span class="line">function common_injector(name, item_comfig, temple_html_text, js_text, css_text) &#123;</span><br><span class="line">    if (item_comfig.enable) &#123;</span><br><span class="line">        if (temple_html_text !== &#x27;&#x27;) &#123;</span><br><span class="line">            var layout_name;</span><br><span class="line">            var layout_type;</span><br><span class="line">            var layout_index = 0;</span><br><span class="line">            if (item_comfig.layout_id) &#123;</span><br><span class="line">                layout_name = item_comfig.layout_id;</span><br><span class="line">                layout_type = &#x27;id&#x27;;</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                layout_name = item_comfig.layout.name;</span><br><span class="line">                layout_type = item_comfig.layout.type;</span><br><span class="line">                layout_index = item_comfig.layout.index;</span><br><span class="line">            &#125;</span><br><span class="line">            var get_layout</span><br><span class="line">            if (layout_type === &#x27;class&#x27;) &#123;</span><br><span class="line">                get_layout = `document.getElementsByClassName(&#x27;$&#123;layout_name&#125;&#x27;)[$&#123;layout_index&#125;]`</span><br><span class="line">            &#125; else if (layout_type === &#x27;id&#x27;) &#123;</span><br><span class="line">                get_layout = `document.getElementById(&#x27;$&#123;layout_name&#125;&#x27;)`</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                get_layout = `document.getElementById(&#x27;$&#123;layout_name&#125;&#x27;)`</span><br><span class="line">            &#125;</span><br><span class="line">            var user_info_js = `&lt;script data-pjax&gt;function $&#123;name&#125;_injector_config()&#123;</span><br><span class="line">                var parent_div_git = $&#123;get_layout&#125;;</span><br><span class="line">                var item_html = &#x27;$&#123;temple_html_text&#125;&#x27;;</span><br><span class="line">                console.log(&#x27;已挂载$&#123;name&#125;&#x27;)</span><br><span class="line">                // parent_div_git.innerHTML=item_html+parent_div_git.innerHTML // 无报错，但不影响使用(支持pjax跳转)</span><br><span class="line">                parent_div_git.insertAdjacentHTML(&quot;afterbegin&quot;,item_html) // 有报错，但不影响使用(支持pjax跳转)</span><br><span class="line">            &#125;if( $&#123;get_layout&#125; &amp;&amp; location.pathname ===&#x27;$&#123;item_comfig.enable_page&#125;&#x27;)&#123;</span><br><span class="line"></span><br><span class="line">            common_injector_config()</span><br><span class="line">        &#125; &lt;/script&gt;`</span><br><span class="line">        &#125;</span><br><span class="line">        hexo.extend.injector.register(&#x27;body_end&#x27;, user_info_js, &quot;default&quot;);</span><br><span class="line">        if (js_text !== &#x27;&#x27;) &#123;</span><br><span class="line">            hexo.extend.injector.register(&#x27;body_end&#x27;, js_text, &quot;default&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">        if (css_text !== &#x27;&#x27;) &#123;</span><br><span class="line">            hexo.extend.injector.register(&#x27;head_end&#x27;, css_text, &quot;default&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">hexo.extend.filter.register(&#x27;after_generate&#x27;,function() &#123;</span><br><span class="line">    if(hexo.config.butterfly_article_double_row_new.enable)&#123;</span><br><span class="line">        var butterfly_article_double_row_comfig = hexo.config.butterfly_article_double_row_new;</span><br><span class="line">        var css_text =`&lt;link rel=&quot;stylesheet&quot; href=&quot;https://haorblog.adhy.cc/blogimg/cardlistpost.min.css&quot;/&gt;</span><br><span class="line">&lt;style&gt;#recent-posts &gt; .recent-post-item &gt;.recent-post-info &gt; .article-meta-wrap &gt; .tags:before &#123;content:&quot;\\A&quot;;</span><br><span class="line">  white-space: pre;&#125;#recent-posts &gt; .recent-post-item &gt;.recent-post-info &gt; .article-meta-wrap &gt; .tags &gt; .article-meta__separator&#123;display:none&#125;&lt;/style&gt;</span><br><span class="line">`</span><br><span class="line"></span><br><span class="line">        common_injector(&#x27;butterfly_article_double_row&#x27;, butterfly_article_double_row_comfig, &#x27;&#x27;, &#x27;&#x27;, css_text)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>如果你没用<code>butterfly_article_double_row</code>的话可以把后面去掉（就是那个让文章并排排列的组件）说白了他就是引入一个css，但是我是在vercel上部署的，还要使用qexo每次部署vercel都会自己安装包，我没办法控制，所以就魔改一下写到这个文件里来改变地址了（里面的链接我已经开防盗链了，不要光想着白嫖🙂 ，只是haorblog.adhy.cc这个开了，剩下的可以放心使用都是大厂的）如果你也用<code>butterfly_article_double_row</code></p><p>那么在你主题的根目录下的配置文件里把原来的开关关掉，新增加</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">butterfly_article_double_row_new:</span><br><span class="line">  enable: true</span><br></pre></td></tr></table></figure><p>这个css的文件链接可以在你的node_modules里找到，看hexo开头的就行了，好像是hexo_butterfly_article_double_row，我也忘了🙂 ，找到以后把上面代码中的替换就行了</p>]]></content>
      
      
      <categories>
          
          <category> 经验分享 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>记录一下第一次作业写这么晚</title>
      <link href="/2022/11/21/20221121/"/>
      <url>/2022/11/21/20221121/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="47aea7e544f426f6d0f03c71285355de01e40ac7975ebbb0e24f078eb1beb6af">8a59e14a029aa73b85cadd971e6fd24ee4daa6ea482cb01c2f199bf3f4f30001a2a46f8ff7511bc25a3b93eaed605e25443a50f9e9e7310a8aa92b25b2184604d207eb3b4d1583d54cb7d77707537309a965569fe3fb043d2d209d612f89a196b9e9456f6278ba93e8355136ba05c72208ebf3408329272e7d8575179a71b25f5a9aa4373c3abea2a8df2d02bf986413</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> 我的日记 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>记一次git的使用错误：error: src refspec main does not match any</title>
      <link href="/2022/11/21/git/"/>
      <url>/2022/11/21/git/</url>
      
        <content type="html"><![CDATA[<p>出现这个错误的原因基本都是git的默认分支是master，而github是main，所以需要</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git branch -m master main</span><br></pre></td></tr></table></figure><p>来更改本地仓库分支</p><p>所以现在git上传的代码应该依次为</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">git init # 在该文件夹中创建本地仓库</span><br><span class="line">git branch -m master main 更改本地仓库分支</span><br><span class="line">git add . # 添加该文件夹下的所有文件到本地仓库</span><br><span class="line">git commit -m &quot;first commit&quot; # 提交暂存区文件并注释</span><br><span class="line">git remote add origin 仓库地址 # 建立本地仓库与远程仓库的关联</span><br><span class="line">git pull --rebase origin main # 将远程仓库的内容合并到本地仓库的 main 分支</span><br><span class="line">git push -u origin main # 本地仓库推送到代码仓库的 main 分支</span><br></pre></td></tr></table></figure><p>或者强制覆盖远程仓库</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">git add . # 添加该文件夹下的所有文件到本地仓库</span><br><span class="line">git branch -m master main 更改本地仓库分支</span><br><span class="line">git commit -m &quot;first commit&quot; # 提交暂存区文件并注释</span><br><span class="line">git remote add origin 仓库地址 # 建立本地仓库与远程仓库的关联</span><br><span class="line">git push -f origin main #强制用本地代码覆盖远程仓库的 main 分支</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 经验分享 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>语文课笔记</title>
      <link href="/2022/11/21/note_yuwen_1121/"/>
      <url>/2022/11/21/note_yuwen_1121/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="de6f5905b16bfb583a03e15e066038d27cf3b5b41aafe84c21aa0ad8735fb652">8a59e14a029aa73b85cadd971e6fd24e3a95f2a04b69a9178d689dc1e6d6673cd1edbab14613d875ed8a82193af28923dbe48dd23f8287175e8b04341672fdcf2d67d9e99192cb0f19ccfe434d210a065e9c8f86c6f32e302bc81eea339faec8ec2c5bc809b071ce742c5137e0bce4d2a78db8390875685018217c306dbb4f5642c58c2e6fff24d00bb7ead3b64eebbb34b3f57c3809cf7d9c8444658f239a23f0f813e0f35a91d62761260cc55820300a8f55377804eb1c073b1496ad1c9cefef213b903a1a6b3c43861ebc94450cbbf09cd51550646040796691ed1db7dc05c7148552072dde39d82030c048c08b72d9830c7ec5315bafea7ef6b00aa533f02f42b4c8a6ade6cd10af94ffe88c50ae6552bc7963866f59393ddf2fa5707bf6047110659863ffd6a4f27ce1057a8c7c9bd1aae80a66d7344c40b25f65da27de515c52d787bf266692f3ecced3ce1a70655d86bbc2869dd16cb29c5aa393881cffe796ef69777e0f984108f58cf95d9a6158159c3639c97c405bf1057d9134a214978b3e0f2c5c8949cf35af86e6ec1cac08385ec0538bdfd1e5ee4c550f79efeb734c9aad370d5a87bf4add4a48b0f404d1c630de10665c838a526707ee40a0c9973a13481122819e74637a289fbc8cc007326628c6ce50611a913713afca63c045f4eb18e6cebc41f021f1e412df8d9ddbcc06e7dc6d61e911340ef779a3d38088f7bb839c6c8f95e0f86fb762630f8bdb9e074e5d5cf52bc7328fbeb0aec8d56b751a3b173a3347ac9191781eda18462aae5e27c84d64cbfb418179ee6750754b21291d36f5a17cba719b75e20c7129b65bbe11fa0fca5e82eef8aea86d1eee1569b6f56fd9b11d4db6d6f0ff2b2bb0b22e70b96f2e38e9d8bcd29fd3b4c29a3ff30cbdde34bf2dbec870d68252973e76f300e73fc7adba6199fb82aabcfeb7887b6a22b5ea0f58f9ee314fa578e8ddf0fda3824a6b977e3ee0a43e10cdd24ac13565d3b1f8bf74d243de07221a8311229581f0b8db9220232c869d1cf6b35f947595690de350e457386469cc349de0d3ecd2077c2f57b035371790227b56e423d8a4fbbbdd2a35ce789bfe71f4461c3275001c66a9ce1fc6e79afdddc81d641fa8076935dd0a4337a4bf866fe64aed7abae4484caea8514ae06b7be83f63a69e2d32a1a348f33259b0df50daed57e23c6c150429523e91ec43dddc23d063f8fac0fdaa98438d3e2ee27eb084056a06999b3733b0cb9237acb5407f8e244665e04410e700819d8a7724351982711bfab4684c6e8df7f8b087a2a5d4f2ce80a8db096b27f1374a2c8e875e3c53357a10a3ef78c0101b1a289f725faff2627da2f2114227f56832b5c3ad8f19b2a53802ebc01d4e125bb8c690024f892dea359743496deb2b5e891a2b01d539cd70c4ada9ef17306774d130dc7f5201b353283a35cabfc3932113a89851827afea36701b4cab6f0c4a361fabeb2b76400f6e0b986493aaed3b70beee93cd954903d55bfebe685d4712ef4d4878a9929c39a444c835a4ef3ad94cb3c2c35d282fc7fc9b75e35e915134cb68d83128a9090181c38a712d97dec4c2236374e3f7baa8ace470522ee6b693503a522209272bc4a198f32bc59720d879677d4a86d88496f7f5466c1e71af1ee0b5b048e3174bba5c0a572fd23c1cbd91d9521669059297af91185f404c826d5d641ccc02c1c34c41279d0f1ab552fbe767e1e59bf2d8d1f8d73b662185f75617e20a5784a4836223223bcb720cf87cee51ee0d30a0d9e77ddaea4665fdaddc96759da355a6282df0c696161091b56e0372a97e111a9a814b0c764811bb7a98c1af5b779959b47dfd9e34868fd7091eb22f19d146d04122cf13d470d1aa0640b1058b45b10c370f78d828242133a704337e4fdbbfcf7bec9d8262e633471bdc17fb7970718facd74d33a8ca2a50a253fd7c24891d7107efc7b5f3cefd4378c4a307d78b647c087361c2541bc1e5bac8caad359a8892be59d77e080cb20ac4945b7f2c76214ebd86536474dd329e78b4dda070d500898841e4f45f87cef920ef5858feaea748c006aff03c353f925deb78b7a075c867773b916b7c43e5c4924b20588f7df3fc278dcd9cb09459b3cd5ffaaa17b34241f9b3b8039a82350ff677769da11ec128ee8e96fea9f35f2def100f1c8e76491d7f2e6da2005a1c724ddd926564c2d70942fd6c121e73529c3c523401721c6c0f27f73ae9fc32ed49fe2dd7b90957326157f0f3a028ac4b7a1025bd8afcefcdfacbd33ce8135507aec0ae10cad2de44a4f9b8f5771b21723df09959144379036b4b833cb1afa5c1c2fdc93beb5efb88414786a9ee614ed3cfb1eb6848cba8a78be06e38db634b6b7c1e8bd52158ae262ba8c7ad84738a5edf9fed191a360398383f13c4683f13edca3aa8c3da9d55e2bc8a613526b82493bd8921f5190fda97fe900259853a10f0e80cff6b2bb8a171cabb0ef119c68056ca8a10a26ad201dad4129c35539108175f55543d60289af658381542829dfbbf14bc68c9fc1e0f4316db8e42ebcb11f0decc508f5fc059a6b07e6cf8455f89529c86f2a6f0fd092e5e14a258f49408154b07c69a2d99ca2a93735f5f805278ca8babd1e4c4ebbaa649d5712e8c103d8896ef3ae1c99177d43a7c2ef040235ca3eb7ca8b7700f554f62877b41fc096c36fc1b19d578312440b318ed840074f08ee3fb46557067364af873bb3300df533ac5509cabba021994ab92930b939385c01471da87a533a22a50ec386308c690bc9b7e75e94bc893219c7c4a670a5e11308edd6cc164bf25df38eb71fe57280e53bda819a92cc8e1eb245dd564b6b12190b9fabc52fae69b69e1c1fca43952ad4345f2cf7d59e83fbbfea7af47863fa4f82a467a7982782d7f9c5e189000d4e8250bf19a7149887362ac399a25df38cc021d3c55d96e2e13a417e4ecbb9acd953386a0f7d5326b8f6827fa948c8ae6ed027c048b7245f3eff4b3958419bfacdb0e338347fba08f3159b35c720a5b2699937339c1f250feb63d09f566941dd7bb2e8d45dd26062fe960466dec7fad75f93ff21f7d1cd3dcbd35fead52f62b6a611f204b2621b2e8e0ffb52b19691a0ea3dc55bb3272b7d05d446848079cacdc7ab0e51430f1badcbe4ae563db1de78634e57bfbe1ff52503599a2f3d47ac85ed486f743319b06741189e5b0e7bd061f39fbc55e59751c99cdcb8ed9f22ddb988e020d2b42f9d49199e7cb8a368995449b8c934b6b9e6feae1cdd8706dccb39f12de0fb210d7941fda971f0d20e4d656be9b797c2e084cb84618bd06750e244692b6303458be4fac8f0319ca4458bd9d80baafd2a4dd7efda80a082aa56206124d0551ddeb58831c5a78c376485b076b9b088d75fc74dbe519594d9faa2b50ce8802ea9811753b823c77e618a79c024f9d9b5e2e5d9fc20a7dcebca7c1f01caf457e7f2bf06b19decb0c8bb8abcdfcde2af181232866a243bbb54e29682c3a4e8a437e9abd3eb84831e3d967c507e149836085c085b19296a2df95cc17cd3d04bddcae7c08a477cbd51b0e968bc4c6f941130d02b2265c5a068e76f0bc6cafe873cb708f8caf4c55c3d26e312edf69ddbee98dc38c72cb9516a0e8c5dde3ebc6b672a58c77c2a674c5c00d760017a0eff28d5a10ad17b623bab6a6a18118b7d1b7b71144349e46305a2d9b20272d259f00cbf7de87ef1905f0bcd42ca44667c01e0948bb19aab9e124a27d9a34ecf82374681c5f6cb57041a3c1ca4a885abeecf15a16302c6d37a21506fb1586c64b6f6681a8f04da9a5e170f814cbc846194b8ac462a36ff069436da0eb141db0bc5712dded5d261bcc86108a22bc7c70698252d1e16efa72bd2ac27da33b70905e108501cd9d81eb649a951fa391a8024857795c77658867d60d1cfe4f0bfbe1a8f963f4656cef5ed4e33ed568d37b17b16f20b58b8f007b391355c9fd1327663287bf74344977b1295569db118b7fcb59775ca9400f6234b43c64c190333b3271c6114a3569be25dd862ed92c808ef4a1a32e580f15fe5c7b9348c3017e1c050f664b4a6125e6c018fe85be1a6c757caf2862e0b48fc11fadef25f9aca518eb82c4c927dd0c583849c1218d3fbe786a14ea9c23f2e30658da7a30614abc9a57bb62ceb336f1853bbf3f6ba17f755a000bab7d729d6ebddb16a30f58e7e57da422e84f7c3657460051160c22799025ce06a356b50636064803a025c686ad2b581f1d5eafb83f3650e8bb9bdf85fc1015ce6fc97fc1f92c75bb87a82fb6071accefd85df9bc56a6c52b6de867bc42a41bf4d8fa8b1338fdc6adbe86f1d01a3bc379152448c7063c09510b8c531db0fbd40c12100367132ca80db72c079fbddb3ee42727ee6faa6cbfe7fab6f3c9a7a3816290816349da4eaec8779b382ca83cdbda8ae48a01bfeb4baec88c59b9b23dfbd4440438bbb5771e2a4886790a009c91cd6ef1ba4becfd7afa406467d1444cfe4c6b6b720b67c87d169005dd6ed439822ea83ff601d52390bc5322dc26d37440ec3617f3170957151bb62caa44c0e3ee1ce8927f37c1d94e3b275b600f3e4a43c2e6ab13283f7fb096a0322c7947eca36880d6d163da1ab99925d6214c195ac59668dfa27d948afbdfb41a61a1d9746198624fc80aa0c893b25773feedea89bcd3e9ff1cb940f91af3d7cca87d90e04469984a9b529ac998aaa5a059712f09a88557f2975697a34d2ca1cd63e68153615815f874bfbbd95f0fb98498891303e26d9549b2622b7f301ec7f6c38f4c505db75a735496ab517483ada5b933b74831decb498265a1960242d2c76174029430e0cba522786ebbb6927e9ec3bc37bd32ac30eb34e2cd2adf6075e1110fdbb4948e3b269ccfb813b49016b3e85ee5e56dc121c2a598305fdda12090934db5df7b6ccb916393b30f70b1649bb3542d0b9d6bd7b023a08507f722b7791b3ded9972173f71179ca5612dfe9c27426bfac68fdd08139fef0a035b69c5277f0c233b3b5b932585a75ddf7da7d0009c1e2dc85e37fb4641016f7f63c7d561b1b0465d07c7540996bbe1698e8462c2975cc5fac230c1b5ac76d9aa6fb9d38558060f49bc2df03861e1e864af6aa1871e2f474c995215cbd13e2ec36ef3b61edd6b1bfad4525a6a717dac0967a40abae20bf1ee13f0dd3eea819e416b6bef92635bd1b3444a6c3f566d293fca2f5517b066a6188f8315ab334d72111d640859996aace707cadd6fac3d643b7f8b5f1603455ef357fe284f1a2d50655c936300a8bc47c150e9a92cf9376f0c6bd2ed55d0b4e05ee2327b6c8deecb90592d0395413a2ad1811dc9e340265a1470e46f3f43ac2864a182550ad30a85478e1a3958126d3d469d751424e0a53fd3d6b6675f4bc8263c9015673e2dfb77a382e98abf569bf77182f1348a67dc7ecee4f7be453ad76bdeb011c095c1741ee6191c0b400305564b86b0c518c2a7a81f1913adb502d0a568377982d47b5ac8672a64ce8483b59685ddca88864e85ac227ffd369644642305e7e7b141744eb20355d027cc7660c99e261d46e4483a6bfa00ef6c4a7de32966daa20e257a4838530d9787784cc2c042543c7b54f241679bd25154a905b5e267688f734af20f155dfd09ac5074ea486077e36b7c4d54863c7218e54311321137d418d772d8da8f1f6695889b6474fa297a91310c44f319dcd6530c1cffd9dda2a2ebc5eb7f65b5deb5f5e188960b798ffc34c70540f048115c7fa6b9fb730ddea8e86eb4fdfc6a02bbe392cce70fe1efb439fa35941d977a7c0eafb67a2a961044b8feacaab8ebb74d74ab461b1b3658f855a8c7aeab649744319976795664c7b6c9066e9f83415d3d2e61c9649a75dc28990c8adc2603e7caae078e7e2f0ab288526f61412d7cc9a6049270d0f4253f137a2570315d3fa93520bec485361863ca2c4c525df5fce651468f617a30b88fbea5c8a2495795167f88723be62c48ed95c79a4bf5bdd92b662035fca7f9b943712f31f4a54a35252b71a1dd8bc0b6bd533d502e42157c448ef8fee3eb2e033734429f3ece4c8573036f15ff7e743337735b347501f91fbb9c2123fcb0584c38a57941c3ce55665254b498a822b8d85cef3666e656f2f1ae28febadef0f9e8091d566c915a876d2e9e4be11d336621fcbc5870fa7c070f56845a46ac02f34c699f282df852313a36305422a89f8ac44d207cbdfd6db5647e5df50e968b7273ad4ba6be0225b8e00f6719f343923e1ff4d67776cc3e64a4ea947a067b9fc253e96e9ea580729672c2d19f480b3b75025cce1b0f83273430eb546c1625573a7a592d6f290e87ddba7d16de74ca97d46f052fd6c54d7032155fda4673e95c5394d0c39ecb060b9378183e5c828b29faa83015837eeb00495170121d40a62ca9ea2603afc97493cb515e4f83187dec45cbdcab94da9147bc9a2d7558a0a3828372dcac53b3cc37a026e8d298c070ed5c3b2ceb9b21e8c250b89dcab06a6c863be1869f6801830a9b0222fba9ffcd5123f4254bfca111560af0362b16f9c027b4f7423f9d1c12a7686feef1a6a9076e5dd5c0c2d1a2c7c6e3c9a11747782d1251882f0576ec1aa9a08c860b3ec37d997a0b7989d6b7fc98ac2d9d268000f2d8438eb5517bdc3c6aafb458f25f160cacbdddda732436ef25507f7d47dc7b929e9119897a75fb50fc8c67f2b04412cc3fb4fc144c9e1cccd80dd16b0ee3f276a275fe15891518584641e12b07576835bf6578ecd16e190c871b9993243e688bbb438c6b5e486f3ad288ccfd8102ee98d6116fb129bc749e724fd36a2b2d87d580f6e1db3ba94ce99f703665f5f5b5a178b17c5fdf942f2ba5f328da4126ca12b0486914a2355caf6f6c25a32edcbe66cbbff1752efe9dc3e83af310590e0f21e78e7c4eaee0a60c346e7b341320310459b717ca7de9db812522d801af9f60da7e83c6616e5fa59754bbd74f32efdcf6bdff1057fe14d76e764334ed3043cbd669666b273863b26fc4501d6d5f60f60362cca93797bddb40fba61a1fc80e40ec8f32e49d7980bf9190e77b714db2b4cbcd766881236df78e09498cd13ae085828347f75a5f7334b94d086040d267210e0a84cb75153e14ce4cc3f2da1cae6a96818e00893f7d8d26f586ba075e5b2af5dfe445b0caf1a3c83535e3104598143d393d00de1a9c53c5a2d2f0e3ab4d6a3b0e4118f6b2af8e4aeb489b50fe4a9f5ac2665e8d2c6072beee7958becd799e910296c2a673af0334c8a6ce2695cf6f85300641e46813c454f0ed6347dab0c38f17348643f5a3b5ca1fc47eaa41bb9e0b1d14f71a2ec7dbf8b0e5d079ee0cef1f808aa2c789f8d1c5a369374ac4ae55a892059903fb228863f56e881709f3652db93d405a476464254b81c316358213b895817a403b2ab3dba44f4c32c52f3b26a17eb5f54ce7572fa4f1491be84e50376c974611cf1ee42a6ec4a37fd9141600c1945a83c4a3c540350a12a6c2d825f470c4dd03bdd9b07c44303486fefe11d17effa3f26d1bd31d0524d8bc7865de5c4d46a11c8cd2940d66f1faec044bb1157c4b38b9a4d1113e67fa1fbdf865568a6fb92e2beb21788ebcb3fdd36374d30e12b9455072d23b9bf14778a5373ee1badbeb5bc1b9969f54c8923026aa8b65b7af87f67c4ce3fa01628ac619ce0b2e4173d070f09fc4fe51650e4d2c7644db52a1b7cf8fcc7b89afd09405b7fc2ef41e3bf03d1ba96bf1a55c9f198a91831a998a024a2b18cd6ca4e5b1cc446cfef5fe254723840cc0ad691a3c4f4359a3de9307392ed0140947f94a6b812206809b319bb1159df98d2c6e579b48906a4177199fa18f336e7804e39d1925bb1609dfecc6099c8acfdbb170fda43d7a7662f968d36de23f940ddeda80b438bc743464fd1e4370f34b056793892fd441859537e2d40cf5b0a9fe7ea8587d04f2a1ac93a06bf10600603</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>cloudflare自选ip</title>
      <link href="/2022/11/19/cloudflare%E8%87%AA%E9%80%89ip/"/>
      <url>/2022/11/19/cloudflare%E8%87%AA%E9%80%89ip/</url>
      
        <content type="html"><![CDATA[<p>众所周知，cloudflare是不限制流量的，而且有免费套餐，所以很多站长都拿它来当作免备案cdn，但是速度有时候有点感人（晚上八点到凌晨一点）于是我今天拿cloudlfareST测试了一些节点，加上网上收集的一些节点，达到最快速度的目的，以下是测速图<br><img src="https://haorblog.adhy.cc/blogimg/cffast.PNG"><br>有时候自己测的速度可能不一样，因为cf的节点总是上蹿下跳的，不稳定，这些大多数都是anycast节点，每个线路都设置了权重，虽然不能说最快，但是也是很稳定的，在域名解析服务商那里添加一个默认解析，再添加一个解析指向cloudflare.abeginner.cn就可以使用了</p>]]></content>
      
      
      <categories>
          
          <category> 经验分享 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>20221119日记</title>
      <link href="/2022/11/19/20221119%E6%97%A5%E8%AE%B0/"/>
      <url>/2022/11/19/20221119%E6%97%A5%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="eb41445aca36e291307b44029e464e517b087ca7d8853b9a80d7b9257d1eb5e8">17d2b210ec5f90f053c8fe4c2c9761e21db1ae36a48b47d4bf2b1df669a1ee48b24fe587638cd888b48ae88f0dbcc7d8f9bb2043e322154fb7d824b84e8c75270669150c4b59a9e7561d06e74658c22445f20342c4413ff6eb7052324676e5ea2554175073790b84992a343629ac11279b05afabe4c87d7d2a16733f28ae4229ede5e36f47f7bd2f80e74d5b4c6b1b2f77d101afe2935ef60c783d1ea907bd99dbec61aae69628702665cd81b6f669b1be02ba85250157494810f7f23087f6ed8e940b018b4fc26402dfa292779ab5544274b6b5808bda7ec1662f3c776823e1b8ff09865b215e074f93c52f252e9aa896807d5706a373e63f2bf03274022c8d</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">不想让你看</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> 我的日记 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>浅谈一下免备案</title>
      <link href="/2022/11/18/%E5%85%8D%E5%A4%87%E6%A1%88/"/>
      <url>/2022/11/18/%E5%85%8D%E5%A4%87%E6%A1%88/</url>
      
        <content type="html"><![CDATA[<p>备案真的好烦的，也不知道国家为什么要这样做虽然这样使网络世界更加安全，但是对于开发者来说越来越麻烦了，主要是我想备案，年龄不够还不让，要么用香港vps，要么就备案，或者用国外的cdn，半个月前我还调试了一下cloudflare里适合大陆的节点，如图<br><img src="https://haorblog.adhy.cc/blogimg/cf1.PNG"><br>虽然国内大部分区域还行，但是一到夜间（晚上八点-凌晨一点）就跟反复横跳一样，能不能连接上全靠运气，于是我想办法找人给开了个备案的子域名，套一下cdn，然后再买个顶级域名，301到备案的子域名上，这样速度和域名的便捷都实现了，用的是多吉云，速度延迟都可以，是融合cdn<br>这是我的邀请链接：<a href="https://console.dogecloud.com/register.html?iuid=4426">https://console.dogecloud.com/register.html?iuid=4426</a><br>香港vps的话，推荐openvps延迟稳定，速度还行，主要是不限流量</p>]]></content>
      
      
      <categories>
          
          <category> 经验分享 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>2022/11/18日记</title>
      <link href="/2022/11/18/1118/"/>
      <url>/2022/11/18/1118/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="7e577bec641f2157c08412e5314029f242d8497a82ddf6183a8dd3bdcc6d4cbb">ca6333df3c00d7aa4147c61dc087dc23c0b71bc816b3db58f66e08a02de5c4b53aefab26860a8febc5af146a7dfbbdc7778245f504552d0405e111dcfc9c64237877d156e81b7da31a79d2764ccf71ffc93a6d67045e46147199b50e24e45bd4</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">不想让你看</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> 我的日记 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>关于cloudflare的配置</title>
      <link href="/2022/09/26/markdown/"/>
      <url>/2022/09/26/markdown/</url>
      
        <content type="html"><![CDATA[<h1 id="欢迎来到我的博客"><a href="#欢迎来到我的博客" class="headerlink" title="欢迎来到我的博客"></a>欢迎来到我的博客</h1><p><img src="https://s1.ax1x.com/2022/09/09/vq7uq0.jpg" alt="vq7uq0.jpg"></p><h3 id="这是我用hexo搭建的博客"><a href="#这是我用hexo搭建的博客" class="headerlink" title="这是我用hexo搭建的博客"></a>这是我用hexo搭建的博客</h3><h3 id="这是博客目前的速度"><a href="#这是博客目前的速度" class="headerlink" title="这是博客目前的速度"></a>这是博客目前的速度</h3><p><img src="https://s1.ax1x.com/2022/09/09/vqHvnI.md.jpg"></p><h3 id="用的是itdog"><a href="#用的是itdog" class="headerlink" title="用的是itdog"></a>用的是<a href="https://itdog.cn/">itdog</a></h3><h3 id="itdog是一个免费的工具箱特别推荐"><a href="#itdog是一个免费的工具箱特别推荐" class="headerlink" title="itdog是一个免费的工具箱特别推荐"></a>itdog是一个免费的工具箱特别推荐</h3><h3 id="原先我是用github-pages-加-hexo-框架，还有butterfly主题搭建博客的，但是呢github-pages访问贼慢，可能是时不时还访问不了，于是我打算套一个cloudflare加速，但是cloudflare加速时不时在国内真的算减速，虽然免备案也支持https和企业级邮箱，而且还免费，他在国外的速度是真的不错，基本ping的延迟都在10以内，但是由于中国国内的种种原因导致他在中国成为了减速cdn，这个问题困扰了我很久，之前直接使用改dns的方法引入cloudflare的cdn的时候，速度和丢包率刷新我的认知，甚至部分地区和联通的线路有丢包100-的，最后我在cloudflare控制台发现了一个pages选项琢磨了一段时间以后发现他跟github-pages差不多，都是免费的静态网站托管，只不过他的最大文件限制是25m，每个月可以500次上传（对于个人来说够用了），最后我用cloudflare-pages-和-腾讯云d监控还有hexo框架和butterfly主题搭建了这个博客总体来说速度还是不错的，只是联通有点慢，毕竟cloudflare里没有适用于联通的节点，下面是我收集的一些高速稳定的cloudflare节点"><a href="#原先我是用github-pages-加-hexo-框架，还有butterfly主题搭建博客的，但是呢github-pages访问贼慢，可能是时不时还访问不了，于是我打算套一个cloudflare加速，但是cloudflare加速时不时在国内真的算减速，虽然免备案也支持https和企业级邮箱，而且还免费，他在国外的速度是真的不错，基本ping的延迟都在10以内，但是由于中国国内的种种原因导致他在中国成为了减速cdn，这个问题困扰了我很久，之前直接使用改dns的方法引入cloudflare的cdn的时候，速度和丢包率刷新我的认知，甚至部分地区和联通的线路有丢包100-的，最后我在cloudflare控制台发现了一个pages选项琢磨了一段时间以后发现他跟github-pages差不多，都是免费的静态网站托管，只不过他的最大文件限制是25m，每个月可以500次上传（对于个人来说够用了），最后我用cloudflare-pages-和-腾讯云d监控还有hexo框架和butterfly主题搭建了这个博客总体来说速度还是不错的，只是联通有点慢，毕竟cloudflare里没有适用于联通的节点，下面是我收集的一些高速稳定的cloudflare节点" class="headerlink" title="原先我是用github pages 加 hexo 框架，还有butterfly主题搭建博客的，但是呢github pages访问贼慢，可能是时不时还访问不了，于是我打算套一个cloudflare加速，但是cloudflare加速时不时在国内真的算减速，虽然免备案也支持https和企业级邮箱，而且还免费，他在国外的速度是真的不错，基本ping的延迟都在10以内，但是由于中国国内的种种原因导致他在中国成为了减速cdn，这个问题困扰了我很久，之前直接使用改dns的方法引入cloudflare的cdn的时候，速度和丢包率刷新我的认知，甚至部分地区和联通的线路有丢包100%的，最后我在cloudflare控制台发现了一个pages选项琢磨了一段时间以后发现他跟github pages差不多，都是免费的静态网站托管，只不过他的最大文件限制是25m，每个月可以500次上传（对于个人来说够用了），最后我用cloudflare pages 和 腾讯云d监控还有hexo框架和butterfly主题搭建了这个博客总体来说速度还是不错的，只是联通有点慢，毕竟cloudflare里没有适用于联通的节点，下面是我收集的一些高速稳定的cloudflare节点"></a>原先我是用github pages 加 hexo 框架，还有butterfly主题搭建博客的，但是呢github pages访问贼慢，可能是时不时还访问不了，于是我打算套一个cloudflare加速，但是cloudflare加速时不时在国内真的算减速，虽然免备案也支持https和企业级邮箱，而且还免费，他在国外的速度是真的不错，基本ping的延迟都在10以内，但是由于中国国内的种种原因导致他在中国成为了减速cdn，这个问题困扰了我很久，之前直接使用改dns的方法引入cloudflare的cdn的时候，速度和丢包率刷新我的认知，甚至部分地区和联通的线路有丢包100%的，最后我在cloudflare控制台发现了一个pages选项琢磨了一段时间以后发现他跟github pages差不多，都是免费的静态网站托管，只不过他的最大文件限制是25m，每个月可以500次上传（对于个人来说够用了），最后我用cloudflare pages 和 腾讯云d监控还有hexo框架和butterfly主题搭建了这个博客总体来说速度还是不错的，只是联通有点慢，毕竟cloudflare里没有适用于联通的节点，下面是我收集的一些高速稳定的cloudflare节点</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">腾讯云的解析可以将不同线路的用户解析到不同的服务器所以只要添加好cname解析以后再添加相同记录选择不同的线路添加解析值就好</span><br><span class="line">万能节点：</span><br><span class="line">1.0.0.1他会自动匹配可以用的节点如果你不想经常调试节点或担心节点挂掉，这个节点最适合你，线路选择默认，添加记录值就好</span><br><span class="line">电信节点：（线路选择电信）</span><br><span class="line">104.23.240.*</span><br><span class="line">走英国德国荷兰等 延迟比美国高一些 适合源站在欧洲的网站</span><br><span class="line">104.16.160.*</span><br><span class="line">圣何塞的线路，比洛杉矶要快一点</span><br><span class="line">108.162.236.*</span><br><span class="line">延迟稳定，但是延迟较高</span><br><span class="line">移动节点：（线路选择移动）</span><br><span class="line">162.158.133.* </span><br><span class="line">198.41.214.*</span><br><span class="line">198.41.212.*</span><br><span class="line">198.41.208.*</span><br><span class="line">198.41.209.*</span><br><span class="line">172.64.32.*</span><br><span class="line">141.101.115.*</span><br><span class="line">172.64.0. *</span><br><span class="line">172.64.16.* </span><br><span class="line">没有啥适合联通的联通的线路，不过你可以选择cloudflare和百度云加速合作的节点:</span><br><span class="line">162.159.211.4-103</span><br><span class="line">103.21.244.0/22</span><br><span class="line">103.22.200.0/22</span><br><span class="line">103.31.4.0/22</span><br><span class="line">104.16.0.0/12</span><br><span class="line">108.162.192.0/18</span><br><span class="line">131.0.72.0/22</span><br><span class="line">141.101.64.0/18</span><br><span class="line">162.158.0.0/15</span><br><span class="line">172.64.0.0/13</span><br><span class="line">173.245.48.0/20</span><br><span class="line">188.114.96.0/20</span><br><span class="line">190.93.240.0/20</span><br><span class="line">197.234.240.0/22</span><br><span class="line">198.41.128.0/17</span><br></pre></td></tr></table></figure><h2 id="总的来说cloudflare还是不错的，毕竟人家免费而且免费的额度不得不说是真的牛逼不像国内某些厂商扣扣索索的，一上来就是收费标准，我用cloudflare在一大堆教程文档里找收费标准，好不容易找到了，说了跟没说一样，差不多可以直接记为免费，而且只要一个邮箱就能用，不像国内还要实名认证（虽然不能怪国内的企业）"><a href="#总的来说cloudflare还是不错的，毕竟人家免费而且免费的额度不得不说是真的牛逼不像国内某些厂商扣扣索索的，一上来就是收费标准，我用cloudflare在一大堆教程文档里找收费标准，好不容易找到了，说了跟没说一样，差不多可以直接记为免费，而且只要一个邮箱就能用，不像国内还要实名认证（虽然不能怪国内的企业）" class="headerlink" title="总的来说cloudflare还是不错的，毕竟人家免费而且免费的额度不得不说是真的牛逼不像国内某些厂商扣扣索索的，一上来就是收费标准，我用cloudflare在一大堆教程文档里找收费标准，好不容易找到了，说了跟没说一样，差不多可以直接记为免费，而且只要一个邮箱就能用，不像国内还要实名认证（虽然不能怪国内的企业）"></a>总的来说cloudflare还是不错的，毕竟人家免费而且免费的额度不得不说是真的牛逼不像国内某些厂商扣扣索索的，一上来就是收费标准，我用cloudflare在一大堆教程文档里找收费标准，好不容易找到了，说了跟没说一样，差不多可以直接记为免费，而且只要一个邮箱就能用，不像国内还要实名认证（虽然不能怪国内的企业）</h2>]]></content>
      
      
      <categories>
          
          <category> 经验分享 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>这是用qexo发布的一篇文章</title>
      <link href="/2022/09/26/test/"/>
      <url>/2022/09/26/test/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="7e7f4c928c3b5319c4629f11d4cee533ba5f4e6fc788f236048bca2f06f78615">ca6333df3c00d7aa4147c61dc087dc2311d3a3974bf13a7a4942d9cc5556166e5cb4d7ff91e30f82b47d63d1a013636a</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">不想让你看</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> 闲得无聊 </category>
          
      </categories>
      
      
    </entry>
    
    
  
  
</search>
